<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 12">
<meta name=Originator content="Microsoft Word 12">
<link rel=File-List href="day12.files/filelist.xml">
<link rel=Edit-Time-Data href="day12.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>WangCongwei</o:Author>
  <o:LastAuthor>Windows 使用者</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2017-07-11T02:41:00Z</o:Created>
  <o:LastSaved>2017-07-11T02:41:00Z</o:LastSaved>
  <o:Pages>23</o:Pages>
  <o:Words>3802</o:Words>
  <o:Characters>21672</o:Characters>
  <o:Lines>180</o:Lines>
  <o:Paragraphs>50</o:Paragraphs>
  <o:CharactersWithSpaces>25424</o:CharactersWithSpaces>
  <o:Version>12.00</o:Version>
 </o:DocumentProperties>
 <o:CustomDocumentProperties>
  <o:KSOProductBuildVer dt:dt="string">2052-10.1.0.5554</o:KSOProductBuildVer>
 </o:CustomDocumentProperties>
</xml><![endif]-->
<link rel=dataStoreItem href="day12.files/item0001.xml"
target="day12.files/props0002.xml">
<link rel=themeData href="day12.files/themedata.thmx">
<link rel=colorSchemeMapping href="day12.files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:DrawingGridVerticalSpacing>7.8 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>ZH-TW</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:DontUseIndentAsNumberingTabStop/>
   <w:FELineBreak11/>
   <w:WW11IndentRules/>
   <w:DontAutofitConstrainedTables/>
   <w:AutofitLikeWW11/>
   <w:HangulWidthLikeWW11/>
   <w:UseNormalStyleForList/>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" LatentStyleCount="267">
  <w:LsdException Locked="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" QFormat="true"
   Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="99" Name="Hyperlink"/>
  <w:LsdException Locked="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="HTML Top of Form"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Normal Table"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="No List"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Outline List 1"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Outline List 2"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Outline List 3"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="99" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="99" SemiHidden="true"
   UnhideWhenUsed="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="99" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="99" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="99" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:宋体;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
@font-face
	{font-family:新細明體;
	panose-1:2 2 5 0 0 0 0 0 0 0;
	mso-font-alt:PMingLiU;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611969 684719354 22 0 1048577 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1107305727 0 0 415 0;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536870145 1073743103 0 0 415 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-520092929 1073786111 9 0 415 0;}
@font-face
	{font-family:等线;
	mso-font-alt:"Arial Unicode MS";
	mso-font-charset:122;
	mso-generic-font-family:auto;
	mso-font-pitch:auto;
	mso-font-signature:0 953122042 22 0 262159 0;}
@font-face
	{font-family:"\@新細明體";
	panose-1:2 2 5 0 0 0 0 0 0 0;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611969 684719354 22 0 1048577 0;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 680460288 22 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:SimSun;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;}
h1
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"標題 1 字元";
	mso-style-next:內文;
	margin-top:9.0pt;
	margin-right:0cm;
	margin-bottom:9.0pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:300%;
	mso-pagination:none;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	mso-fareast-font-family:新細明體;
	mso-font-kerning:26.0pt;
	mso-fareast-language:ZH-CN;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-priority:39;
	mso-style-unhide:no;
	mso-style-next:內文;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	font-size:10.5pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:SimSun;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-unhide:no;
	mso-style-link:"頁首 字元";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:SimSun;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-unhide:no;
	mso-style-link:"頁尾 字元";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	mso-pagination:none;
	tab-stops:center 207.65pt right 415.3pt;
	layout-grid-mode:char;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	mso-fareast-font-family:SimSun;
	mso-bidi-font-family:"Times New Roman";
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	mso-themecolor:hyperlink;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-unhide:no;
	color:purple;
	mso-themecolor:followedhyperlink;
	text-decoration:underline;
	text-underline:single;}
span.a
	{mso-style-name:"頁首 字元";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:頁首;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;}
span.a0
	{mso-style-name:"頁尾 字元";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:頁尾;
	mso-font-kerning:1.0pt;
	mso-fareast-language:ZH-CN;}
span.1
	{mso-style-name:"標題 1 字元";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"標題 1";
	mso-ansi-font-size:26.0pt;
	mso-bidi-font-size:26.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-fareast-font-family:新細明體;
	mso-hansi-font-family:Cambria;
	mso-font-kerning:26.0pt;
	mso-fareast-language:ZH-CN;
	font-weight:bold;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	mso-ascii-font-family:Calibri;
	mso-fareast-font-family:SimSun;
	mso-hansi-font-family:Calibri;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;
	mso-footnote-separator:url("day12.files/header.htm") fs;
	mso-footnote-continuation-separator:url("day12.files/header.htm") fcs;
	mso-endnote-separator:url("day12.files/header.htm") es;
	mso-endnote-continuation-separator:url("day12.files/header.htm") ecs;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:表格內文;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-unhide:no;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Calibri","sans-serif";
	mso-bidi-font-family:"Times New Roman";}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="3074"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=ZH-TW link=blue vlink=purple style='tab-interval:21.0pt;
text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<p class=MsoNormal><span lang=EN-US style='font-size:20.0pt;mso-bidi-font-size:
24.0pt;font-family:等线;mso-bidi-font-family:等线'>day12<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 414.8pt'><!--[if supportFields]><span
lang=EN-US><span style='mso-element:field-begin'></span><span
style='mso-spacerun:yes'> </span>TOC \o &quot;1-3&quot; \h \z \u <span
style='mso-element:field-separator'></span></span><![endif]--><span lang=EN-US><span
class=MsoHyperlink><span style='mso-no-proof:yes'><a href="#_Toc487532985"><span
lang=ZH-CN style='font-family:等线;mso-bidi-font-family:等线'>第一集</span><span
style='font-family:等线;mso-bidi-font-family:等线'><span style='mso-spacerun:yes'> 
</span></span><span lang=ZH-CN style='font-family:等线;mso-bidi-font-family:等线'>软件锁的界面设计和功能实现</span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>... </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc487532985 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>1</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400380037003500330032003900380035000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
style='mso-no-proof:yes'><o:p></o:p></span></span></p>

<p class=MsoToc1 style='tab-stops:right dotted 414.8pt'><span
class=MsoHyperlink><span lang=EN-US style='mso-no-proof:yes'><a
href="#_Toc487532986"><span lang=ZH-CN style='font-family:等线;mso-bidi-font-family:
等线'>第二集</span><span style='font-family:等线;mso-bidi-font-family:等线'><span
style='mso-spacerun:yes'>  </span></span><span lang=ZH-CN style='font-family:
等线;mso-bidi-font-family:等线'>短信备份与还原</span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>... </span></span><!--[if supportFields]><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-element:field-begin'></span></span><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'> PAGEREF _Toc487532986 \h </span><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-separator'></span></span><![endif]--><span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'>19</span><span style='color:windowtext;display:none;
mso-hide:screen;text-decoration:none;text-underline:none'><!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003400380037003500330032003900380036000000</w:data>
</xml><![endif]--></span><!--[if supportFields]><span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-element:field-end'></span></span><![endif]--></a></span></span><span
lang=EN-US style='mso-no-proof:yes'><o:p></o:p></span></p>

<p class=MsoNormal><!--[if supportFields]><span lang=EN-US><span
style='mso-element:field-end'></span></span><![endif]--><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h1><a name="_Toc487532985"><span lang=ZH-CN style='font-size:14.0pt;
mso-bidi-font-size:18.0pt;line-height:300%;font-family:等线;mso-bidi-font-family:
等线;mso-font-kerning:1.0pt'>第一集</span></a><span style='mso-bookmark:_Toc487532985'><span
lang=EN-US style='font-size:14.0pt;mso-bidi-font-size:18.0pt;line-height:300%;
font-family:等线;mso-bidi-font-family:等线;mso-font-kerning:1.0pt'><span
style='mso-spacerun:yes'>  </span></span></span><span style='mso-bookmark:_Toc487532985'><span
lang=ZH-CN style='font-size:14.0pt;mso-bidi-font-size:18.0pt;line-height:300%;
font-family:等线;mso-bidi-font-family:等线;mso-font-kerning:1.0pt'>软件锁的界面设计和功能实现</span></span><span
style='mso-bookmark:_Toc487532985'></span><span lang=EN-US style='font-size:
14.0pt;mso-bidi-font-size:18.0pt;line-height:300%;font-family:等线;mso-bidi-font-family:
等线;mso-font-kerning:1.0pt'><o:p></o:p></span></h1>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>在昨天实现了软件锁的数据库。现在来实现软件锁的界面功能。为了不重复制造轮子，所以此功能在软件管理模块中实现。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>在软件管理模块的</span><span lang=EN-US>SoftMangaerActivity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>中的界面上增加如下图中右边的锁：</span></p>

<p class=MsoNormal><span lang=EN-US><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="图片_x0020_1" o:spid="_x0000_i1025" type="#_x0000_t75"
 style='width:137.25pt;height:198pt;mso-position-horizontal-relative:page;
 mso-position-vertical-relative:page'>
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="day12.files/image001.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=183 height=264
src="day12.files/image002.jpg" v:shapes="图片_x0020_1"><![endif]></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>然后在</span><span lang=EN-US>SoftMangaerActivity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的</span><span lang=EN-US>ViewHolder</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>类中增加此</span><span lang=EN-US>ImageView</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>控件：</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>。。。</span></p>

<p class=MsoNormal><span lang=EN-US>static class ViewHolder</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>ImageView
iv_itemsoftmanage_icon, <span style='color:blue'>iv_itemsoftmanager_islock</span>;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>TextView
tv_softmanager_name, tv_softmanager_issd, tv_softmanager_version;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>。。。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>在</span><span lang=EN-US>SoftMangaerActivity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的</span><span lang=EN-US>getView</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>方法中如下设置锁控件的初始显示状态：</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>。。。。</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>判断应用程序是加锁还是解锁</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>if
(watchDogDao.queryLockApp(appInfo.getPackagName()))</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>其中：</span><span lang=EN-US>watchDogDao</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>在</span><span lang=EN-US>SoftMangaerActivity</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的</span><span lang=EN-US>onCreate</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>方法中初始化；</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>此处的判断为：如果数据库中存在此条目对应的程序的包名，说明为加锁</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置锁控件为加锁状态</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>viewHolder.iv_itemsoftmanager_islock.setImageResource(R.drawable.lock);</span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>注意給</span><span lang=EN-US>viewHolder.iv_itemsoftmanager_islock</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>设置缓存复用</span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>}
else</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>设置锁控件为解锁状态</span><span lang=EN-US> <span style='mso-tab-count:3'>                      </span></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US>viewHolder.iv_itemsoftmanager_islock.setImageResource(R.drawable.unlock);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>}</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>。。。。</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>然后在</span><span lang=EN-US>SoftMangaerActivity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的</span><span lang=EN-US>onCreate</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>方法中调用如下方法，把相应的条目对应的程序添加到数据库（加锁）或者从数据库删除（解锁）：</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US>/**</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-spacerun:yes'> </span>* </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>这里的条目短按操作是弹出</span><span
lang=EN-US>popuwindow</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>，为了区分出弹出</span><span
lang=EN-US>popuwindow</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>和设置程序</span><span
lang=EN-US><span style='mso-tab-count:1'>   </span></span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>加锁解锁，所以设置后者为长按点击事件</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
void listviewItemLongClick()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>lv_softmanager_application.setOnItemLongClickListener(new
<span style='mso-tab-count:3'>                     </span></span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt'><span
lang=EN-US>OnItemLongClickListener()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>public
boolean onItemLongClick(AdapterView&lt;?&gt; parent, View view, int position, <span
style='mso-tab-count:3'>                       </span>long id)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>System.out.println(&quot;</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>长按点击事件</span><span lang=EN-US>&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>屏蔽用户和系统程序</span><span lang=EN-US>(..</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>个</span><span lang=EN-US>)</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>不能进行加锁解锁操作</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>if
(position == 0 || position == userappinfo.size() - 1 + 1 + 1)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>return
true;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取数据</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>if
(position &lt;= userappinfo.size() - 1 + 1)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>用户程序</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>appInfo
= userappinfo.get(position - 1);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}
else</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>系统程序</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>appInfo
= systemappinfo.get(position - userappinfo.size() - 2);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>加锁解锁</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>ViewHolder
viewHolder = (ViewHolder) view.getTag();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>判断应用有没有加锁</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>有的话解锁</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>没有的加锁：和</span><span lang=EN-US>CheckBox</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>一样，总</span><span lang=EN-US><span style='mso-tab-count:4'>                                </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>之设置为相反即可</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>if
(watchDogDao.queryLockApp(appInfo.getPackagName()))</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>解锁操作：把程序包名从数据库中删除即可</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>watchDogDao.deleteLockApp(appInfo.getPackagName());</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:12'>                                                                                                                </span></span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US>viewHolder.iv_itemsoftmanager_islock.setImageResource(R.drawable.unlock);</span></p>

<p class=MsoNormal style='margin-left:42.0pt;text-indent:21.0pt'><span
lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>更新界面数据</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}
else</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>加锁操作</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>判断如果是当前应用程序</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>就不要加锁：否则会一直弹出解锁界面：</span></p>

<p class=MsoNormal style='margin-left:84.0pt;text-indent:21.0pt'><span
lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>手机卫士加了锁，每次打开的时候要求解锁，弹出解锁界面；但是</span><span
lang=EN-US> </span></p>

<p class=MsoNormal style='margin-left:84.0pt;text-indent:21.0pt'><span
lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>解锁界面又属于手机卫士项目，又要求解锁，再弹出解锁界面，如</span><span
lang=EN-US><span style='mso-tab-count:1'> </span>//</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>此往复循环弹出解锁界面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>if
(!appInfo.getPackagName().equals(getPackageName()))</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>watchDogDao.addLockApp(appInfo.getPackagName());</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span></span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US>viewHolder.iv_itemsoftmanager_islock.setImageResource(R.drawable.lock);</span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>更新界面数据</span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>}
else</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>Toast.makeText(getApplicationContext(),
&quot;</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>当前的应用程序不能加</span><span lang=EN-US><span
style='mso-tab-count:6'>                                                  </span></span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>锁</span><span lang=EN-US>&quot;, 0).show();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
myadapter.notifyDataSetChanged();</span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>上面已经通过</span><span lang=EN-US>viewHolder</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>更新过，所以这里就不再更新</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
true:</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>表示执行</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
false:</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>拦截</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>如果这里设置为</span><span lang=EN-US>false</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>，则长按操作执行完后，还会去执行短按操作</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>为了使二者区分开，不相互受影响，所以设置为</span><span lang=EN-US>true</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>return
true;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>});</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>以上是设置锁控件的状态，以及把程序添加到数据库或者从数据库删除；下面根据数据库中的数据来设置看门狗服务的功能：</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>新建一个看门狗（</span><span lang=EN-US>Service</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>）</span><span lang=EN-US>:</span></p>

<p class=MsoNormal><span lang=EN-US>//</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>现在考虑什么时候开启此服务，什么时候关闭此服务：</span><span
lang=EN-US> </span></p>

<p class=MsoNormal><span lang=EN-US>//</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>同号码归属地功能是否开启交由用户去选择一样，这里的是否开启软件锁也交由用户去选择</span></p>

<p class=MsoNormal><span lang=EN-US>//</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>所以在</span><span
lang=EN-US>SetingActivity</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>中增加如下条目：</span></p>

<p class=MsoNormal><span lang=EN-US><!--[if gte vml 1]><v:shape id="图片_x0020_4"
 o:spid="_x0000_i1026" type="#_x0000_t75" style='width:152.25pt;height:207pt;
 mso-position-horizontal-relative:page;mso-position-vertical-relative:page'>
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="day12.files/image003.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=203 height=276
src="day12.files/image004.jpg" v:shapes="图片_x0020_4"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US>//</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>并在</span><span
lang=EN-US>SetingActivity</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>的</span><span
lang=EN-US>onStart</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>方法中调用如下方法：</span></p>

<p class=MsoNormal><span lang=EN-US>/*</span></p>

<p class=MsoNormal><span lang=EN-US>* </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>软件锁</span></p>

<p class=MsoNormal><span lang=EN-US>*</span></p>

<p class=MsoNormal><span lang=EN-US>private void lock()</span></p>

<p class=MsoNormal><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>动态的获取服务是否开启</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>if
(AdressUtils.isRunningService(&quot;com.itheima.mobliesafe75.service.WatchDogService&quot;,
getApplicationContext()))</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>开启服务</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>sv_setting_lock.setChecked(true);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}
else</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>关闭服务</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>sv_setting_lock.setChecked(false);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>sv_setting_lock.setOnClickListener(new
OnClickListener()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>public
void onClick(View v)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>Intent
intent = new Intent(SettingActivity.this, WatchDogService.class);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>根据</span><span lang=EN-US>checkbox</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的状态设置描述信息的状态</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
isChecked() : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>之前的状态</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>if
(sv_setting_lock.isChecked())</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>关闭提示更新</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>stopService(intent);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>更新</span><span lang=EN-US>checkbox</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的状态</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>sv_setting_lock.setChecked(false);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>}
else</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>打开提示更新</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>startService(intent);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>sv_setting_lock.setChecked(true);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>});</span></p>

<p class=MsoNormal><span lang=EN-US>}</span></p>

<p class=MsoNormal><span lang=EN-US>*/</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>//</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>看门狗如下：</span></p>

<p class=MsoNormal><span lang=EN-US>public class WatchDogService extends
Service</span></p>

<p class=MsoNormal><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
WatchDogDao watchDogDao;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
boolean isLock;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
List&lt;String&gt; list;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
IBinder onBind(Intent intent)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>return
null;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
void onCreate()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>super.onCreate();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='color:#072FD7'><span style='mso-tab-count:1'>         </span>watchDogDao
= new WatchDogDao(getApplicationContext());<o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>时时刻刻监听用户打开的程序</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
activity</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>都是存放在任务栈中的</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>一个应用只有一个任务栈</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>final
ActivityManager am = (ActivityManager) getSystemService(ACTIVITY_SERVICE);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span><span
style='color:#072FD7'>isLock = true;<o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>new
Thread()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>public
void run()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{</span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US style='color:#072FD7'>list = watchDogDao.querAllLockApp();<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US style='color:#072FD7'>//</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#072FD7'>从数据库查询所有的数据</span><span
lang=EN-US style='color:#072FD7'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:63.0pt;text-indent:21.0pt'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>while
(isLock)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>监听操作</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>监听用户打开了哪些任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>打开哪些应用</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取正在运行的任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>如果任务栈运行</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>就表示应用打开过</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
maxNum : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>获取正在运行的任务栈的个数</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>现在打开的应用的任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>永远在第一个</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>而之前</span><span lang=EN-US>(</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>点击</span><span
lang=EN-US>home</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>最小</span><span lang=EN-US><span
style='mso-tab-count:5'>                                           </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>化</span><span lang=EN-US>,</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>没有退出</span><span
lang=EN-US>)</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>的应用的任务栈会依次往后推</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>List&lt;RunningTaskInfo&gt;
runningTasks = am.getRunningTasks(1);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>System.out.println(&quot;----------------------&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>for
(RunningTaskInfo runningTaskInfo : runningTasks)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>栈底的</span><span lang=EN-US>activity</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>ComponentName
baseactivity = runningTaskInfo.baseActivity;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span></span></p>

<p class=MsoNormal style='margin-left:84.0pt;text-indent:21.0pt'><span
lang=EN-US><span style='mso-tab-count:1'>         </span>/*</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span><span
style='mso-spacerun:yes'> </span>* //</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>获取任务栈栈顶的</span><span
lang=EN-US>activity runningTaskInfo.topActivity;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span><span
style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>String
packageName = baseactivity.getPackageName();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>System.out.println(packageName);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span></span></p>

<p class=MsoNormal style='margin-left:105.0pt;text-indent:21.0pt'><span
lang=EN-US>// </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>判断</span><span lang=EN-US>list</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>集合中是否包含包名</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>boolean
b = list.contains(packageName);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>通过查询数据库</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>如果数据库中有</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>说明程序是加了锁的，点击</span><span lang=EN-US><span style='mso-tab-count:6'>                                                </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>此程序要弹出解锁界面</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>没有不作处理</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>if
(b)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>弹出解锁界面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>Intent
intent = new Intent(WatchDogService.this, <span style='mso-tab-count:8'>                                                                        </span><span
style='mso-tab-count:1'>         </span>WatchDogActivity.class);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>//
WatchDogActivity</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>：解锁界面见后</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>intent.putExtra(&quot;packageName&quot;,
packageName);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>startActivity(intent);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>System.out.println(&quot;----------------------&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>SystemClock.sleep(300);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>};</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}.start();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
void onDestroy()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>super.onDestroy();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>当服务关闭的时候禁止看门狗监听用户打开应用程序</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>isLock
= false;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>WatchDogActivity</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>界面布局文件如下：</span></p>

<p class=MsoNormal><span lang=EN-US><!--[if gte vml 1]><v:shape id="图片_x0020_5"
 o:spid="_x0000_i1027" type="#_x0000_t75" style='width:131.25pt;height:95.25pt;
 mso-position-horizontal-relative:page;mso-position-vertical-relative:page'>
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="day12.files/image005.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=175 height=127
src="day12.files/image006.jpg" v:shapes="图片_x0020_5"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>/**</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'> </span>* </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>解锁界面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US>public class WatchDogActivity extends
Activity</span></p>

<p class=MsoNormal><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
ImageView iv_watchdog_icon;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
TextView tv_watchdog_name;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
EditText ed_watchdog_password;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
String packagename;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>protected
void onCreate(Bundle savedInstanceState)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>super.onCreate(savedInstanceState);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>setContentView(R.layout.activity_watchdog);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>iv_watchdog_icon
= (ImageView) findViewById(R.id.iv_watchdog_icon);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>tv_watchdog_name
= (TextView) findViewById(R.id.tv_watchdog_name);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>ed_watchdog_password
= (EditText) findViewById(R.id.ed_watchdog_password);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>接受看门狗传递过来的数据：</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>Intent
intent = getIntent();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>packagename
= intent.getStringExtra(&quot;packageName&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置显示加了锁的应用程序的图标和名称</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>PackageManager
pm = getPackageManager();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>try</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>ApplicationInfo
applicationInfo = pm.getApplicationInfo(packagename, 0);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>Drawable
icon = applicationInfo.loadIcon(pm);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>String
name = applicationInfo.loadLabel(pm).toString();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置显示</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>iv_watchdog_icon.setImageDrawable(icon);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>tv_watchdog_name.setText(name);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}
catch (NameNotFoundException e)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>e.printStackTrace();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>protected
void onStart()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>super.onStart();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>protected
void onStop()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>super.onStop();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>finish();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>一旦界面退回后台，就销毁此解锁界面，否则会出现以下问题：</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>当用户解锁第一个程序弹出解锁界面，然后点击</span><span lang=EN-US>Home</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>按钮的时候，再解锁第</span><span lang=EN-US><span style='mso-tab-count:2'>              </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>二个程序弹出解锁界面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>由于解锁界面在后台未被销毁，就会保存第一个界面的图标和名称，不会变为</span><span
lang=EN-US><span style='mso-tab-count:2'>             </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>第二个程序的图标和名称，</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>为了防止这个问题的发生，所以一旦解锁界面退回后台必须销毁</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>再次显示的时候重新走</span><span lang=EN-US>onCreate</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>方法，重新创建图标和名称，就会更新为第二</span><span lang=EN-US><span style='mso-tab-count:
2'>            </span>//</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>个程序的图标和名称</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
boolean onKeyDown(int keyCode, KeyEvent event)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>if
(keyCode == KeyEvent.KEYCODE_BACK)// </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>返回键</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-tab-count:2'>                   </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>从某个界面点击返回键返回到桌面的</span><span lang=EN-US>LogCat</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>日志信息如下：</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>可根据此设置在</span><span lang=EN-US>WatchDogActivity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>界面点击返回键的时候也跳转到桌面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>/**</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span><span
style='mso-spacerun:yes'> </span>* Starting: Intent {
act=android.intent.action.MAIN</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span><span
style='mso-spacerun:yes'> </span>* cat=[android.intent.category.HOME ]</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span><span
style='mso-spacerun:yes'> </span>*
cmp=com.android.launcher/com.android.launcher2.Launcher } from</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-tab-count:2'>                   </span><span
style='mso-spacerun:yes'> </span>* pid 208</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span><span
style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>跳转到主界面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>Intent
intent = new Intent();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>intent.setAction(&quot;android.intent.action.MAIN&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>intent.addCategory(&quot;android.intent.category.HOME&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>startActivity(intent);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>finish();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>return
super.onKeyDown(keyCode, event);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>/**</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-spacerun:yes'> </span>* </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>解锁按钮的点击事件</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
void lock(View v)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取输入的密码</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>String
password = ed_watchdog_password.getText().toString().trim();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
2.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>判断密码是否输入正确</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>if
(&quot;123&quot;.equals(password))</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>解锁：这里一定要通知看门狗应用程序已经解锁，不要再弹出解锁界面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>否则看门狗会一直弹出解锁界面</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>一般通过广播的形式将信息发送给看门狗服务</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>Intent
intent = new Intent();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>intent.setAction(&quot;com.itheima.mobliesafe75.unlock&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>自定义广播事件</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>intent.putExtra(&quot;packagename&quot;,
packagename);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>sendBroadcast(intent);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>finish();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}
else</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>Toast.makeText(getApplicationContext(),
&quot;</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>密码错误</span><span lang=EN-US>&quot;,
0).show();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>为了使解锁界面返回的信息能被看门狗获得，所以看门狗中还需要设置广播接收者：</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>在</span><span lang=EN-US>WatchDogService</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>中：</span></p>

<p class=MsoNormal><span lang=EN-US>public class WatchDogService extends
Service</span></p>

<p class=MsoNormal><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
WatchDogDao watchDogDao;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
boolean isLock;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>private
List&lt;String&gt; list;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='color:blue'>private String unlockcurrentPackagname;<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='color:blue'>private UnlockCurrentReceiver unlockCurrentReceiver;<o:p></o:p></span></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='color:blue'>private ScreenOffReceiver screenOffReceiver;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
IBinder onBind(Intent intent)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>return
null;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='color:blue'>/**<o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span><span style='mso-spacerun:yes'> </span>* </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:blue'>获取解锁界面返回的解锁成功的应用程序的包名；一旦解锁成功看门狗就不要再连</span><span
lang=EN-US style='color:blue'><span style='mso-tab-count:2'>            </span></span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:blue'>续弹出解锁此程序的解锁界面</span><span lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span><span style='mso-spacerun:yes'> </span>*/<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span>private class UnlockCurrentReceiver extends
BroadcastReceiver<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>@Override<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>public void onReceive(Context context, Intent
intent)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:blue'>解锁成功的程序的包名</span><span lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>unlockcurrentPackagname =
intent.getStringExtra(&quot;packagename&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span>/**<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='color:blue'>* </span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>解锁成功后，用户可以正常使用程序了。但是在锁屏以后，就应该再对这个程序进行加锁</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span><span style='mso-spacerun:yes'> </span>*/<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span>private class ScreenOffReceiver extends BroadcastReceiver<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>@Override<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>public void onReceive(Context context, Intent
intent)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:blue'>加锁的操作</span><span lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>unlockcurrentPackagname = null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
1'>         </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
void onCreate()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>super.onCreate();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>watchDogDao
= new WatchDogDao(getApplicationContext());</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span><span
style='color:blue'>// </span></span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>注册监听解锁成功的广播接受者</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>// 1.</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>广播接受者</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>unlockCurrentReceiver = new
UnlockCurrentReceiver();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>// 2.</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>设置接受的广播事件：解锁界面解锁成功的自定义广播事件</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>IntentFilter intentFilter = new IntentFilter();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>intentFilter.addAction(&quot;com.itheima.mobliesafe75.unlock&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>// 3.</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>注册广播接受者</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>registerReceiver(unlockCurrentReceiver,
intentFilter);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>// </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>注册锁屏的广播接受者</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>screenOffReceiver = new ScreenOffReceiver();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>IntentFilter screenOffIntentFilter = new IntentFilter();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>screenOffIntentFilter.addAction(Intent.ACTION_SCREEN_OFF);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>registerReceiver(screenOffReceiver,
screenOffIntentFilter);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>时时刻刻监听用户打开的程序</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
activity</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>都是存放在任务栈中的</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>一个应用只有一个任务栈</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>final
ActivityManager am = (ActivityManager) getSystemService(ACTIVITY_SERVICE);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>isLock
= true;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>new
Thread()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>public
void run()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>list
= watchDogDao.querAllLockApp();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>while
(isLock)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>监听操作</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>监听用户打开了哪些任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>打开哪些应用</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取正在运行的任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>如果任务栈运行</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>就表示应用打开过</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
maxNum : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>获取正在运行的任务栈的个数</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>现在打开的应用的任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>永远在第一个</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>而之前</span><span lang=EN-US>(</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>点击</span><span
lang=EN-US>home</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>最小</span><span lang=EN-US><span
style='mso-tab-count:5'>                                           </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>化</span><span lang=EN-US>,</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>没有退出</span><span
lang=EN-US>)</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>的应用的任务栈会依次往后推</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>List&lt;RunningTaskInfo&gt;
runningTasks = am.getRunningTasks(1);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>System.out.println(&quot;----------------------&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>for
(RunningTaskInfo runningTaskInfo : runningTasks)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span><span
style='mso-tab-count:1'>         </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>获取任务栈</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>栈底的</span><span lang=EN-US>activity</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>ComponentName
baseactivity = runningTaskInfo.baseActivity;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>/*</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span><span
style='mso-spacerun:yes'> </span>* //</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>获取任务栈栈顶的</span><span
lang=EN-US>activity runningTaskInfo.topActivity;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span><span
style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>String
packageName = baseactivity.getPackageName();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>System.out.println(packageName);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>判断</span><span lang=EN-US>list</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>集合中是否包含包名</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>boolean
b = list.contains(packageName);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>通过查询数据库</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>如果数据库中有</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>弹出解锁界面</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>没有不作处</span><span lang=EN-US><span style='mso-tab-count:6'>                                                   </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>理</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>if
(b)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span><span
style='color:blue'>if (!packageName.equals(unlockcurrentPackagname))<o:p></o:p></span></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
7'>                                                                 </span>// </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:blue'>如果获取到的包名不是解锁成功的程序的包名</span><span lang=EN-US
style='color:blue'>,</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>就弹出解</span><span
lang=EN-US style='color:blue'><span style='mso-tab-count:7'>                                                          </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:blue'>锁界面，否则就不要弹出解锁界面</span><span lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
7'>                                                                 </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>弹出解锁界面</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>Intent
intent = new Intent(WatchDogService.this, <span style='mso-tab-count:8'>                                                                        </span><span
style='mso-tab-count:1'>         </span>WatchDogActivity.class);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>//
WatchDogActivity</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>：解锁界面见后</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>intent.putExtra(&quot;packageName&quot;,
packageName);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>startActivity(intent);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>System.out.println(&quot;----------------------&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>SystemClock.sleep(300);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>};</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}.start();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>@Override</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
void onDestroy()</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>super.onDestroy();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>当服务关闭的时候禁止看门狗监听用户打开的应用程序</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>isLock
= false;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span><span
style='color:blue'>// </span></span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>注销解锁的广播接受者</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>if (unlockCurrentReceiver != null)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>unregisterReceiver(unlockCurrentReceiver);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>unlockCurrentReceiver = null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>// </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:blue'>注销锁屏的广播接受者</span><span
lang=EN-US style='color:blue'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>if (screenOffReceiver != null)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>unregisterReceiver(screenOffReceiver);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
3'>                            </span>screenOffReceiver = null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:blue'><span style='mso-tab-count:
2'>                   </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>现在来看一个</span><span lang=EN-US>Bug:</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>具体</span><span lang=EN-US>bug</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>比较复杂，大体是要将解锁界面设置成某一种启动模式，否则程序解锁之后会返回到手机卫士去，详见今天的视频《</span><span
lang=EN-US>07.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>两个</span><span lang=EN-US>bug</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的解决方案》。现在来看看四种启动模式。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;color:red'>面试题：</span><span lang=EN-US
style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:red'>standard : </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>标准的启动模式</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:red'>singleTop : </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>如果</span><span lang=EN-US style='color:red'>activity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>在栈顶</span><span lang=EN-US style='color:red'>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>直接使用</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:red'>singleTask : </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>如果任务栈中有</span><span lang=EN-US style='color:red'>activity,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>则其之前的</span><span lang=EN-US style='color:red'>activity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>全部删除</span><span lang=EN-US style='color:red'>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>将此</span><span lang=EN-US style='color:red'>activity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>置顶</span><span lang=EN-US style='color:red'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:red'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:red'>singleInstance : </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>将</span><span lang=EN-US style='color:red'>activity</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:red'>单独存放在一个任务栈中</span></p>

<p class=MsoNormal><span lang=EN-US>---&gt;</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>这里的解锁界面应该设置为</span><span lang=EN-US>singleInstance </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>模式，让其单独在一个任务栈中，解除其与手机卫士项目的关联；否则其会和手机卫士项目关联起来，某些情况下程序解锁后会回到手机卫士去，而我们需要的是，解锁后进入解锁的程序去，而不是手机卫士。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>关于</span><span lang=EN-US>excludeFromRecents</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>的</span><span lang=EN-US>Bug</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>无需掌握。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>现在来看另一个问题：</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>在</span><span lang=EN-US>WatchDogService</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>中，之前的设置是在</span><span lang=EN-US>whlie</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>循环中，每隔</span><span lang=EN-US>300</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>毫秒去查询数据库；这是极为消耗</span><span lang=EN-US>CUP</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>等资源的。可以先把数据库中的所有数据先查询出来放在集合中，然后在从集合中去取数据，就能减少</span><span lang=EN-US>CPU</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>等资源的消耗。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>在</span><span lang=EN-US>WatchDogService</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>中如下：</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>       
</span></span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>。。。。。</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                                             
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>new
Thread()<span style='mso-spacerun:yes'>                      </span><span
style='mso-spacerun:yes'>                                                                                      </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{<span
style='mso-spacerun:yes'>                                                                                                                      
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                              </span><span
style='mso-spacerun:yes'>                                                                                  </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>public
void run()<span
style='mso-spacerun:yes'>                                                                                                  
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{<span
style='mso-spacerun:yes'>                                                                                                                  
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                                                               
</span><span style='color:#0070C0'><span
style='mso-spacerun:yes'>           </span><span
style='mso-spacerun:yes'>                                                            </span></span></span></p>

<p class=MsoNormal style='margin-left:84.0pt'><span lang=EN-US
style='color:#0070C0'>//</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>当数据库变化的时候通知内容观察者数据库变化了</span><span
lang=EN-US style='color:#0070C0'>, </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>从而更新集合</span><span
lang=EN-US style='color:#0070C0'>list<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:84.0pt'><span lang=EN-US
style='color:#0070C0'>//</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>中的数据：</span><span
lang=EN-US style='color:#0070C0'><span style='mso-spacerun:yes'>   </span><span
style='mso-spacerun:yes'>                                                                                                                                                    </span><span
style='mso-spacerun:yes'>                      </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:4'>                                     </span>Uri uri =
Uri.parse(&quot;content://com.itheima.mobliesafe75.lock.changed&quot;);<span
style='mso-spacerun:yes'>                                         </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-spacerun:yes'>                                                                                                                   
</span><span style='mso-spacerun:yes'>            </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:4'>                                     </span>//
notifyForDescendents:</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>匹配规则</span><span
lang=EN-US style='color:#0070C0'>,true:</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>精确匹配</span><span lang=EN-US style='color:#0070C0'>
false:</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>模糊匹配</span><span
lang=EN-US style='color:#0070C0'><span
style='mso-spacerun:yes'>                                                              
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:4'>                                     </span>getContentResolver().registerContentObserver(uri,
true, new <span style='mso-tab-count:6'>                                                 </span><span
style='mso-tab-count:1'>         </span>ContentObserver(null)<span
style='mso-spacerun:yes'>                               </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span><span style='mso-tab-count:
2'>                   </span>{<span
style='mso-spacerun:yes'>                                                                                                              
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:5'>                                               </span>public
void onChange(boolean selfChange)<span
style='mso-spacerun:yes'>                                                                   
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:5'>                                               </span>{<span
style='mso-spacerun:yes'>                     </span><span
style='mso-spacerun:yes'>                                                                                      </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;color:#0070C0'>更新数据</span><span lang=EN-US
style='color:#0070C0'><span
style='mso-spacerun:yes'>                                                                                                
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:6'>                                                        </span>list
= watchDogDao.querAllLockApp();<span style='mso-spacerun:yes'>               
</span><span
style='mso-spacerun:yes'>                                                    </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:5'>                                               </span>};<span
style='mso-spacerun:yes'>                                                                                                         
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:4'>                                     </span>});<span
style='mso-spacerun:yes'>                                                                                 
</span><span style='mso-spacerun:yes'>                           </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-spacerun:yes'>                                                                                                                               
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:4'>                                     </span>// </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>先将数据库中的数据全部查出存放到集合</span><span lang=EN-US
style='color:#0070C0'>,</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>然后从集合中获取数据进行</span><span
lang=EN-US style='color:#0070C0'><span style='mso-tab-count:4'>                              </span></span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>操作</span><span lang=EN-US style='color:#0070C0'><span
style='mso-spacerun:yes'>                                                      
</span><span style='mso-spacerun:yes'>                     </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:4'>                                     </span>// </span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>这样可以减少数据库的访问次数，降低</span><span lang=EN-US
style='color:#0070C0'>CPU</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>的损耗</span><span
lang=EN-US style='color:#0070C0'><span
style='mso-spacerun:yes'>                                                                                     
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:4'>                                     </span></span><span
lang=EN-US>list = watchDogDao.querAllLockApp();<span style='mso-spacerun:yes'> 
</span><span style='color:#0070C0'><span
style='mso-spacerun:yes'>                        </span></span><span
style='mso-spacerun:yes'>                                                  </span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                                                               
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>while
(isLock)<span
style='mso-spacerun:yes'>                                                                                                 
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>{<span
style='mso-spacerun:yes'>     </span><span
style='mso-spacerun:yes'>                                                                                                          </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>监听操作</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                                    
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>监听用户打开了哪些任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>打开哪些应用</span><span lang=EN-US><span style='mso-spacerun:yes'>       
</span><span
style='mso-spacerun:yes'>                                                                              </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取正在运行的任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>如果任务栈运行</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>就表示应用打开过</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                             
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
maxNum : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>获取正在运行的任务栈的个数</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                 </span><span
style='mso-spacerun:yes'>                                                  </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>现在打开的应用的任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>永远在第一个</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>而之前</span><span lang=EN-US>(</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>点击</span><span
lang=EN-US>home</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>最小</span><span lang=EN-US><span
style='mso-tab-count:5'>                                           </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>化</span><span lang=EN-US>,</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>没有退出</span><span
lang=EN-US>)</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>的应用的任务栈会依次往后推</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                     
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>List&lt;RunningTaskInfo&gt;
runningTasks = am.getRunningTasks(1);<span
style='mso-spacerun:yes'>                    </span><span
style='mso-spacerun:yes'>                             </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>System.out.println(&quot;----------------------&quot;);<span
style='mso-spacerun:yes'>                                                              
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>for
(RunningTaskInfo runningTaskInfo : runningTasks)<span
style='mso-spacerun:yes'>                                                      
</span><span style='mso-spacerun:yes'> </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>{<span
style='mso-spacerun:yes'>                                                                                                          
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取任务栈</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>栈底的</span><span lang=EN-US>activity<span
style='mso-spacerun:yes'>                                                                                   
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>ComponentName
baseactivity = runningTaskInfo.baseActivity;<span
style='mso-spacerun:yes'>                                              </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>/*<span
style='mso-spacerun:yes'>                                                                                                     
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span><span
style='mso-spacerun:yes'> </span>* //</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>获取任务栈栈顶的</span><span
lang=EN-US>activity runningTaskInfo.topActivity;<span
style='mso-spacerun:yes'>       </span><span
style='mso-spacerun:yes'>                                               </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span><span
style='mso-spacerun:yes'> </span>*/<span
style='mso-spacerun:yes'>                                                                                                    
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>String
packageName = baseactivity.getPackageName();<span
style='mso-spacerun:yes'>                                        </span><span
style='mso-spacerun:yes'>       </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>System.out.println(packageName);<span
style='mso-spacerun:yes'>                                                                       
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                                                               
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>判断</span><span lang=EN-US>list</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>集合中是否包含包名：从集合中取出数据进行判断操</span><span lang=EN-US><span style='mso-tab-count:
6'>                                               </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>作</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                      
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>boolean
b = list.contains(packageName);<span
style='mso-spacerun:yes'>                                                                
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>通过查询集合</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>如果集合中有</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>弹出解锁界面</span><span lang=EN-US>,</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>没有就不作处理</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                        
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>if
(b)<span
style='mso-spacerun:yes'>                                                                                                 
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>{<span
style='mso-spacerun:yes'>            </span><span style='color:#0070C0'><span
style='mso-spacerun:yes'>                                    </span></span><span
style='mso-spacerun:yes'>             </span><span
style='mso-spacerun:yes'>                                          </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span>if
(!packageName.equals(unlockcurrentPackagname))<span
style='mso-spacerun:yes'>                                                  
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>如果获取到的包名不是解锁成功的程序的包名</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>就弹出解</span><span lang=EN-US><span style='mso-tab-count:7'>                                                          </span>//</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>锁界面，否则就不要弹出解锁界面</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                              </span><span
style='mso-spacerun:yes'>           </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span>{<span
style='mso-spacerun:yes'>                                                                                                  
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>弹出解锁界面</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                      
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>Intent
intent = new Intent(WatchDogService.this, <span style='mso-tab-count:8'>                                                                        </span><span
style='mso-tab-count:1'>         </span>//WatchDogActivity.class);<span
style='mso-spacerun:yes'>                       </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>//
WatchDogActivity</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>：解锁界面见后</span><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                     
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                 
</span><span
style='mso-spacerun:yes'>                                                              </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);<span
style='mso-spacerun:yes'>                                                
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                       
</span><span
style='mso-spacerun:yes'>                                        </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>intent.putExtra(&quot;packageName&quot;,
packageName);<span
style='mso-spacerun:yes'>                                                   
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                                                             
</span><span style='mso-spacerun:yes'>                  </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:8'>                                                                           </span>startActivity(intent);<span
style='mso-spacerun:yes'>                                                                         
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:7'>                                                                 </span>}<span
style='mso-spacerun:yes'>                                                                                                  
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:6'>                                                        </span>}<span
style='mso-spacerun:yes'>                 </span><span
style='mso-spacerun:yes'>                                                                                      </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>}<span
style='mso-spacerun:yes'>                                                                                                          
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                      
</span><span
style='mso-spacerun:yes'>                                                                         </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>System.out.println(&quot;----------------------&quot;);<span
style='mso-spacerun:yes'>                                                              
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span
style='mso-spacerun:yes'>                                                                   
</span><span
style='mso-spacerun:yes'>                                                            </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:5'>                                               </span>SystemClock.sleep(300);<span
style='mso-spacerun:yes'>                                                                                    
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>}<span
style='mso-spacerun:yes'>                                                                           
</span><span
style='mso-spacerun:yes'>                                   </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>};<span
style='mso-spacerun:yes'>                                                                                                                 
</span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}.start();<span
style='mso-spacerun:yes'>         </span></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>此外，当往数据库中增加数据或者删除数据的时候，说明数据库发生了变化，此时就要通知内容观察者更新集合中的数据，所以在</span><span
lang=EN-US>WatchDogDao</span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>中：</span><span
lang=EN-US><span style='mso-spacerun:yes'>    </span></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>。。。。</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='color:#0070C0'>private Context context;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:1'>         </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>在构造函数中获取</span><span lang=EN-US style='color:#0070C0'>BlackNumOpenHlper<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:1'>         </span>public WatchDogDao(Context context)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:1'>         </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>watchDogOpenHelper = new
WatchDogOpenHelper(context);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>this.context = context;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:1'>         </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>。。。。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US>public void addLockApp(String packageName)</span></p>

<p class=MsoNormal><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取数据库</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>SQLiteDatabase
database = watchDogOpenHelper.getWritableDatabase();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
2.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>添加操作</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
ContentValues :</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>　添加的数据</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>ContentValues
values = new ContentValues();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>values.put(&quot;packagename&quot;,
packageName);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>database.insert(WatchDogOpenHelper.DB_NAME,
null, values);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span><span
style='color:#0070C0'>// </span></span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>通知内容观察者数据库变化了</span><span
lang=EN-US style='color:#0070C0'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>ContentResolver
contentResolver = context.getContentResolver();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>因为是我们自己的数据发生变化了</span><span lang=EN-US style='color:
#0070C0'>,</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>所以我们要自定义一个</span><span
lang=EN-US style='color:#0070C0'>uri</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>进行操作</span><span
lang=EN-US style='color:#0070C0'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>Uri uri =
Uri.parse(&quot;content://com.itheima.mobliesafe75.lock.changed&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>通知内容观察者数据发生变化了</span><span lang=EN-US style='color:#0070C0'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>contentResolver.notifyChange(uri,
null);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
3.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>关闭数据库</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>database.close();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}<span
style='mso-spacerun:yes'>       </span></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>。。。。</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>    
</span>public void deleteLockApp(String packagename)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取数据库</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>SQLiteDatabase
database = watchDogOpenHelper.getWritableDatabase();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
2.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>删除</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
table : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>表名</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
whereClause : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>查询的条件</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
whereArgs : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>查询条件的参数</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>database.delete(WatchDogOpenHelper.DB_NAME,
&quot;packagename=?&quot;, new String[]</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{
packagename });</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span><span
style='color:#0070C0'>// </span></span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>通知内容观察者数据库变化了</span><span
lang=EN-US style='color:#0070C0'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>ContentResolver
contentResolver = context.getContentResolver();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>因为是我们自己的数据发生变化了</span><span lang=EN-US style='color:
#0070C0'>,</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>所以我们要自定义一个</span><span
lang=EN-US style='color:#0070C0'>uri</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;color:#0070C0'>进行操作</span><span
lang=EN-US style='color:#0070C0'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>Uri uri = Uri.parse(&quot;content://com.itheima.mobliesafe75.lock.changed&quot;);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>// </span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri;color:#0070C0'>通知内容观察者数据发生变化了</span><span lang=EN-US style='color:#0070C0'><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US style='color:#0070C0'><span
style='mso-tab-count:2'>                   </span>contentResolver.notifyChange(uri,
null);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
3.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>关闭数据库</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>database.close();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'>            
</span></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>。。。。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<h1><a name="_Toc487532986"><span lang=ZH-CN style='font-size:14.0pt;
mso-bidi-font-size:18.0pt;line-height:300%;font-family:等线;mso-bidi-font-family:
等线;mso-font-kerning:1.0pt'>第二集</span></a><span style='mso-bookmark:_Toc487532986'><span
lang=EN-US style='font-size:14.0pt;mso-bidi-font-size:18.0pt;line-height:300%;
font-family:等线;mso-bidi-font-family:等线;mso-font-kerning:1.0pt'><span
style='mso-spacerun:yes'>  </span></span></span><span style='mso-bookmark:_Toc487532986'><span
lang=ZH-CN style='font-size:14.0pt;mso-bidi-font-size:18.0pt;line-height:300%;
font-family:等线;mso-bidi-font-family:等线;mso-font-kerning:1.0pt'>短信备份与还原</span></span><span
style='mso-bookmark:_Toc487532986'></span><span lang=EN-US style='font-size:
14.0pt;mso-bidi-font-size:18.0pt;line-height:300%;font-family:等线;mso-bidi-font-family:
等线;mso-font-kerning:1.0pt'><o:p></o:p></span></h1>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>在高级工具模块增加如下两个按钮：</span></p>

<p class=MsoNormal><span lang=EN-US><!--[if gte vml 1]><v:shape id="_x0000_i1028"
 type="#_x0000_t75" alt="" style='width:133.5pt;height:102pt'>
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="day12.files/image007.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=178 height=136
src="day12.files/image008.jpg" v:shapes="_x0000_i1028"><![endif]></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>短信的数据库如下：</span></p>

<p class=MsoNormal><span lang=EN-US><!--[if gte vml 1]><v:shape id="图片_x0020_7"
 o:spid="_x0000_i1029" type="#_x0000_t75" alt="" style='width:159pt;height:80.25pt'>
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="day12.files/image009.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=212 height=107
src="day12.files/image010.jpg" v:shapes="图片_x0020_7"><![endif]></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>找到如下表：</span></p>

<p class=MsoNormal><span lang=EN-US><!--[if gte vml 1]><v:shape id="图片_x0020_8"
 o:spid="_x0000_i1030" type="#_x0000_t75" alt="" style='width:140.25pt;
 height:156.75pt'>
 <v:fill o:detectmouseclick="t"/>
 <v:imagedata src="day12.files/image011.png" o:title=""/>
</v:shape><![endif]--><![if !vml]><img width=187 height=209
src="day12.files/image012.jpg" v:shapes="图片_x0020_8"><![endif]></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>以及</span><span lang=EN-US>address</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>（短信发件人）、</span><span lang=EN-US>data</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>（日期）、</span><span lang=EN-US>type</span><span lang=ZH-CN
style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>（</span><span lang=EN-US>1</span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>代表接收，</span><span
lang=EN-US>2</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>代表发送）、</span><span lang=EN-US>body</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>（短信内容）几个字段。</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>创建一个备份短信的工具类：</span></p>

<p class=MsoNormal><span lang=EN-US>/**</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'> </span>*</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>备份短信的工具类</span><span lang=EN-US> </span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'> </span>*</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US>public class SMSEngine</span></p>

<p class=MsoNormal><span lang=EN-US>{</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>//
1.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>创建刷子</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
interface ShowProgress</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置最大进度</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>public
void setMax(int max);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置当前进度</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>public
void setProgress(int progerss);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>//
2.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>媳妇给你刷子</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>/**</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-spacerun:yes'> </span>* </span><span lang=ZH-CN style='font-family:
SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>获取短信</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span><span
style='mso-spacerun:yes'> </span>*/</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>public
static void getAllSMS(Context context, ShowProgress showProgress)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>获取短信</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.1</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>获取内容解析者</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>ContentResolver
resolver = context.getContentResolver();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.2</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>获取内容提供者地址</span><span lang=EN-US>
sms:sms</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>表的地址</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.3</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>获取查询路径</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>Uri
uri = Uri.parse(&quot;content://sms&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
1.4.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>查询操作</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
projection : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>查询的字段</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
selection : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>查询的条件</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
selectionArgs : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>查询条件的参数</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
sortOrder : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>排序</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>Cursor
cursor = resolver.query(uri, new String[]</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{
&quot;address&quot;, &quot;date&quot;, &quot;type&quot;, &quot;body&quot; },
null, null, null);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>增加读写短信的权限</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置最大进度</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>int
count = cursor.getCount();// </span><span lang=ZH-CN style='font-family:SimSun;
mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri'>获取短信的个数</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>showProgress.setMax(count);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置当前进度</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>int
progress = 0;</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
2.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>备份短信</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>格式如下：</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>/*&lt;?xml
version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>&lt;smss&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>&lt;sms&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;address&gt;5556&lt;/address&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;date&gt;4522452345234&lt;/date&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;type&gt;1&lt;/type&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;body&gt;i
miss you&lt;/body&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>&lt;/sms&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>&lt;sms&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;address&gt;5556&lt;/address&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;date&gt;4522452345234&lt;/date&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;type&gt;1&lt;/type&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;body&gt;i
miss you&lt;/body&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>&lt;/sms&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>&lt;sms&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;address&gt;5556&lt;/address&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;date&gt;4522452345234&lt;/date&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;type&gt;1&lt;/type&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>&lt;body&gt;i
miss you&lt;/body&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>&lt;/sms&gt;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>&lt;/smss&gt;*/</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>//
2.1</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>获取</span><span lang=EN-US>xml</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>序列器</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>XmlSerializer
xmlSerializer = Xml.newSerializer();</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>try</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
2.2</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>设置</span><span lang=EN-US>xml</span><span
lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;mso-hansi-font-family:
Calibri'>文件保存的路径</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
os : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>保存的位置</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
encoding : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>编码格式</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>xmlSerializer.setOutput(new
FileOutputStream(new <span style='mso-tab-count:6'>                                                 </span><span
style='mso-spacerun:yes'> </span><span style='mso-tab-count:2'>                </span><span
style='mso-tab-count:1'>         </span>File(&quot;/mnt/sdcard/backupsms.xml&quot;)),
&quot;utf-8&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
2.3</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>设置头信息</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
standalone : </span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>是否独立保存</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>xmlSerializer.startDocument(&quot;utf-8&quot;,
true);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
2.4</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>设置根标签</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>xmlSerializer.startTag(null,
&quot;smss&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
1.5.</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>解析</span><span lang=EN-US>cursor</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>while
(cursor.moveToNext())</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>SystemClock.sleep(1000);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
2.5</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>设置短信的标签</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.startTag(null,
&quot;sms&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
2.6</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>设置文本内容的标签</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.startTag(null,
&quot;address&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>String
address = cursor.getString(0);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.text(address);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.endTag(null,
&quot;address&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.startTag(null,
&quot;date&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>String
date = cursor.getString(1);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.text(date);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.endTag(null,
&quot;date&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.startTag(null,
&quot;type&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>String
type = cursor.getString(2);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.text(type);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.endTag(null,
&quot;type&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.startTag(null,
&quot;body&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>String
body = cursor.getString(3);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.text(body);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.endTag(null,
&quot;body&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>xmlSerializer.endTag(null,
&quot;sms&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>System.out.println(&quot;address:&quot;
+ address + &quot;<span style='mso-spacerun:yes'>   </span>date:&quot; + date +
&quot;<span style='mso-spacerun:yes'>  </span>type:&quot; + type + &quot;<span
style='mso-spacerun:yes'>  </span>body:&quot; + body);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>//
</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri'>设置当前进度</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>progress++;</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:4'>                                     </span>showProgress.setProgress(progress);</span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>xmlSerializer.endTag(null,
&quot;smss&quot;);</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>xmlSerializer.endDocument();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>//
2.8</span><span lang=ZH-CN style='font-family:SimSun;mso-ascii-font-family:
Calibri;mso-hansi-font-family:Calibri'>将数据刷新到文件中</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>xmlSerializer.flush();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span></span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}
catch (Exception e)</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>{</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:3'>                            </span>e.printStackTrace();</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:2'>                   </span>}</span></p>

<p class=MsoNormal><span lang=EN-US><span style='mso-tab-count:1'>         </span>}</span></p>

</div>

</body>

</html>
